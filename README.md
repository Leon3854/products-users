# Система управления товарными запасами и пользователями (E-commerce Core)

## Сервисы товаров и истории: Логистический блок.
## Сервис пользователей: CRM-блок.

## Ключевые технологии: Node.js, Nest.js, TypeScript, PostgreSQL, Prisma, TypeORM, REST API.

## Основные реализованные блоки:
### Service: Stock & Inventory (Складской учет)
Разработал масштабируемую систему управления остатками товаров (PLU) с поддержкой распределенного хранения (склад/полка).
Реализовал гибкую систему фильтрации товаров по множеству параметров (диапазоны остатков, артикулы, магазины).
Спроектировал механизмы атомарного изменения остатков (increase/decrease) для обеспечения целостности данных.
Service: Action History (Логирование изменений)
Создал выделенный сервис для отслеживания истории действий с товарами.
Реализовал фильтрацию событий по типам действий, временным интервалам и конкретным магазинам.
Внедрил постраничную навигацию (pagination) для эффективной работы с большими объемами логов.
Service: User CRM (Управление пользователями)
Спроектировал сервис обработки высоконагруженной базы пользователей (1M+ записей).
Оптимизировал массовые операции обновления данных (Reset Flags): логика реализована на уровне высокопроизводительных запросов к БД для минимизации нагрузки на CPU и RAM.
Настроил автоматическую генерацию тестовых данных большого объема с использованием Faker для нагрузочного тестирования методов.
Архитектурные решения:
Использовал полиглотный подход к инструментам (Nest.js + Prisma для сложных доменов и Express-based подходы для легковесных сервисов).
Разделил бизнес-логику на независимые сервисы для упрощения масштабирования (Inventory vs History).
Обеспечил строгую типизацию данных на базе TypeScript.


### Сервис остатков товаров

#### Поля товара:
- **PLU**: Артикул товара
- **Название товара**
- **Количество товара на полке**
- **Количество товара в заказе**
- **Магазин, для которого данные остатка**

#### Эндпоинты:
- `POST /products`: Создание товара
- `POST /stocks`: Создание остатка
- `PATCH /stocks/increase`: Увеличение остатка
- `PATCH /stocks/decrease`: Уменьшение остатка
- `GET /stocks`: Получение остатков по фильтрам
  - Параметры: `plu`, `shop_id`, `quantity_on_shelf_min`, `quantity_on_shelf_max`, `quantity_in_order_min`, `quantity_in_order_max`
- `GET /products`: Получение товаров по фильтрам
  - Параметры: `name`, `plu`

### Сервис истории действий с товарами

#### Эндпоинты:
- `GET /history`: Получение истории действий с фильтрами
  - Параметры: `shop_id`, `plu`, `date_min`, `date_max`, `action`
  - Поддерживает постраничную навигацию.

## Технологии

- **СУБД**: PostgreSQL
- **Фреймворк**: Один сервис на JavaScript, другой на TypeScript (не Nest.js).

---

## Сервис управления пользователями

#### Поля пользователя:
- **Имя**
- **Фамилия**
- **Возраст**
- **Пол**
- **Проблемы**: boolean (есть ли проблемы у пользователя)

#### Эндпоинты:
- `PATCH /users/resetProblems`: Устанавливает флаг проблемы у пользователей в false и считает количество пользователей, у которых этот флаг был true.

## Технологии

- **Фреймворк**: Nodejs
- **СУБД**: PostgreSQL
- **ORM**: Prisma
- **Фейковые данные**: Используется библиотека `@faker-js/faker` для генерации данных




